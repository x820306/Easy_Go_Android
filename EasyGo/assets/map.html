<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<script type="text/javascript" 
        src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=true"></script>
<script type="text/javascript">
var geocoder;
var map;
var directionsService;
var directionsDisplay=null;
var stepDisplay;
var marker_s=null;
var marker_e=null;
var sp=null;
var ep=null;
var addr_s;
var addr_e;



  function initialize() {
    var myLatlng = new google.maps.LatLng(25.047968, 121.517081);  //地圖中心點
    var myOptions = {
           zoom: 17,
           center: myLatlng,
           mapTypeId: google.maps.MapTypeId.ROADMAP               //道路地圖
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
	geocoder = new google.maps.Geocoder();
	directionsService = new google.maps.DirectionsService();
	stepDisplay = new google.maps.InfoWindow();
  }
  
  function startLocation() {
	 
	  		var lat = window.android.GetLat();
          	var lon = window.android.GetLon();
	 
	  
			 var latlng = new google.maps.LatLng(lat,lon);
			 geocoder.geocode({'latLng': latlng}, function(results, status) {
     			 if (status == google.maps.GeocoderStatus.OK) {
        			if (results[0]) {
						var temp=results[0].formatted_address;
						window.android.setStartLocation(temp);
					}
                 } else {
                    
                 }
             });
  }
  
   function endLocation() {
	 
	  		var lat = window.android.GetLatE();
          	var lon = window.android.GetLonE();
	 
	  
			 var latlng = new google.maps.LatLng(lat,lon);
			 geocoder.geocode({'latLng': latlng}, function(results, status) {
     			 if (status == google.maps.GeocoderStatus.OK) {
        			if (results[0]) {
						var temp=results[0].formatted_address;
						window.android.setEndLocation(temp);
					}
                 } else {
                    
                 }
             });
  }
  
  function frp() {
	  	addr_s = window.android.GetsAddr();
        addr_e = window.android.GeteAddr();
		
		geocoder.geocode( { 'address': addr_s}, function(results, status) {
      		if (status == google.maps.GeocoderStatus.OK) {
        		map.setCenter(results[0].geometry.location);
       			if(marker_s!=null)
				{
					marker_s.setMap(null);
				}
				marker_s = new google.maps.Marker({
            		map: map,
            		position: results[0].geometry.location
        		});
				sp=results[0].geometry.location;
		
    			geocoder.geocode( { 'address': addr_e}, function(results1, status1) {
      				if (status1 == google.maps.GeocoderStatus.OK) {
        				map.setCenter(results1[0].geometry.location);
						if(marker_e!=null)
						{
							marker_e.setMap(null);
						}
        				marker_e = new google.maps.Marker({
            				map: map,
            				position: results1[0].geometry.location
        				});
						ep=results1[0].geometry.location;
						
						window.android.frpReturn();
						
					} else {
        				
      				}
	  			});
		 	} else {
        		
      		}
	  	});
	  
	}
  
</script>
</head>
<body style="margin:0px; padding:0px;" onLoad="initialize()">
  <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>